<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>Earth Imitation</title>
    <script src="../scripts/lib/jquery.min.js"></script>
    <script src="../scripts/lib/three.js"></script>
    <script src="../scripts/controls/TrackballControls.js"></script>
    <script src="../scripts/lib/dat.gui.js"></script>
    <script src="../scripts/EarthModel.js"></script>
    <style>
        body{
            margin:0;
        }
        #container {
            margin:0;
        }
    </style>
</head>
<body>
<div id="container">

</div>
</body>
<script>
    var WINDOW_H = window.innerHeight, WINDOW_W = window.innerWidth;
    var container;
    var scene, camera, renderer;
    var controller;

    //参数列表
    var r = 20;     //球体半径
    var lineLongitude = 30;     //经线数量
    var lineLatitude = 30;      //纬线数量
    var pts2d = [];     //构造地球的点的二维数组
    var pts1d = [];     //构造地球的点的一维数组

    init();
    animate();

    function init() {

        container = document.getElementById( "container" );
        camera = new THREE.PerspectiveCamera( 75, WINDOW_W / WINDOW_H, 1, 100000 );
        scene = new THREE.Scene();
        renderer = new THREE.WebGLRenderer();
        renderer.setClearColor( 0x000000 );
        renderer.setSize( WINDOW_W, WINDOW_H );
        container.appendChild( renderer.domElement );
        controller = new THREE.TrackballControls( camera, container );
        controller.rotateSpeed = 5.0;

        var lightD = new THREE.DirectionalLight( 0xFFFFFF, 0.7 );
        lightD.position.set( 100, 100, 0 );
        scene.add( lightD );

        var lightA = new THREE.AmbientLight( 0x666666 );
        scene.add( lightA );

        //init earth model
        var earthModel = new EarthModel( r, 36 );
        earthModel.createMesh();
        var earthMesh = earthModel.earthMesh;

        for( var i = 0; i < earthMesh.lineMesh.length; i ++ ) {

            scene.add( earthMesh.lineMesh[ i ] );

        }

        earthModel.createFaceMesh( "../data/textures/earth_atmos_4096.jpg", function(){
            console.log( earthMesh.faceMesh );
            console.log( earthModel.earthMesh.faceMesh );
            scene.add( earthMesh.faceMesh );
        });

        //var lightA = new THREE.AmbientLight( 0xFFFFFF );
        //scene.add(lightA);


        camera.position.z = 40;

    }

    function animate() {

        requestAnimationFrame( animate );
        renderer.render( scene, camera );
        controller.update();

    }

</script>
</html>
